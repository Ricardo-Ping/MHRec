This submission includes only the essential parts of the code; the complete version will be made available upon receipt.